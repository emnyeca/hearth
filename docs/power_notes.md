# Power Notes（Rev0）

この文書は、電源回路の設計・切り分けを **DMMだけ** で行うためのメモ。

## 方針
- 「測れる」「切れる」「戻せる」を優先
- フォルト時に外部機器を巻き込まない（逆流、過電流）

## USB-C入力（5V Sink固定）
- CC1/CC2 に Rd（5.1kΩ）を実装して 5V Sink を確定
- VBUSにはESD保護と（必要なら）入力ヒューズ/ポリスイッチを検討

## PowerPath + 充電
- USB接続時：SYS供給 + バッテリー充電
- USB未接続時：バッテリー→SYS供給

## DC 9V入力（センターマイナス / Power Only）
- USBが使えない場面向けの「給電のみ」入力
- DC9Vは降圧してSYS相当レール（SYS）を生成する
- 重要：DC9Vは **BQ充電ICの入力へ接続しない**（DC9Vから充電しない）
- 切替：ジャック検出接点は制御信号にのみ使用し、実電流の遮断/合流はFET/理想ダイオード系で行う

DMM切り分けしやすい構成例：
- VBUS / BAT / SYS の各点にテストパッド
- CHG/PGのLED化（抵抗経由）

## +3V3
- LDOで生成
- テストパッド：+3V3
- ダミー負荷：段階式（例：100mA相当まで）

## +5V
- ブーストで生成
- Boost Enable/Disable を“ジャンパ”で確実に切れるようにする
- テストパッド：+5V
- ダミー負荷：段階式（例：50mA/100mA/…）

## LED表示の注意
- LEDは小電流でも点灯するため、
  - 「LEDが薄く光る＝電源が生きている」ではない
  - 逆にLED回路が“幽霊電圧”の原因になることがある

推奨：
- 各レールに“放電抵抗（例：100k〜330k）”を置く（DMMでの安定観測用）
- LEDは『レール→抵抗→LED→GND』の単純系に寄せる

## DMMだけでの基本チェック
- USB接続：VBUS=5V、SYSの立ち上がり、CHG/PGの状態
- バッテリー：BAT電圧、SYS電圧、充電時のBAT上昇
- +3V3：無負荷で規定電圧、ダミー負荷で電圧低下が許容内
- +5V：Boost Enableの切替で明確にON/OFF、負荷での電圧維持

補足：
- USB_PGOOD_OD / CHG_STAT_OD はオープンドレイン出力として扱い、Hearth側はデフォルトでプルアップしない（DNPフットプリントのみ）
